!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define("ngx-indexed-db",["exports"],r):r((e=e||self)["ngx-indexed-db"]={})}(this,function(e){"use strict";var r=function(){function e(e,r){this.utils=new t,this.dbWrapper=new o(e,r)}return e.prototype.openDatabase=function(e,r){var t=this;return new Promise(function(o,n){t.dbWrapper.dbVersion=e;var a=t.utils.indexedDB.open(t.dbWrapper.dbName,e);a.onsuccess=function(e){t.dbWrapper.db=a.result,o()},a.onerror=function(e){n((e.target.errorCode,e.target.errorCode+" ("+e.target.error+")"))},"function"==typeof r&&(a.onupgradeneeded=function(e){r(e,t.dbWrapper.db)})})},e.prototype.getByKey=function(e,r){var t=this;return new Promise(function(o,a){t.dbWrapper.validateBeforeTransaction(e,a),t.dbWrapper.createTransaction(t.dbWrapper.optionsGenerator(n.readonly,e,a,o)).objectStore(e).get(r).onsuccess=function(e){o(e.target.result)}})},e.prototype.getAll=function(e,r,t){var o=this;return new Promise(function(a,i){o.dbWrapper.validateBeforeTransaction(e,i);var d,p=o.dbWrapper.createTransaction(o.dbWrapper.optionsGenerator(n.readonly,e,i,a)).objectStore(e),s=[];if(t){var c=p.index(t.indexName),u="desc"===t.order?"prev":"next";d=c.openCursor(r,u)}else d=p.openCursor(r);d.onerror=function(e){i(e)},d.onsuccess=function(e){var r=e.target.result;r?(s.push(r.value),r.continue()):a(s)}})},e.prototype.add=function(e,r,t){var o=this;return new Promise(function(a,i){o.dbWrapper.validateBeforeTransaction(e,i),o.dbWrapper.createTransaction(o.dbWrapper.optionsGenerator(n.readwrite,e,i,a)).objectStore(e).add(r,t).onsuccess=function(e){t=e.target.result,a(e)}})},e.prototype.count=function(e,r){var t=this;return new Promise(function(o,a){var i;t.dbWrapper.validateBeforeTransaction(e,a),(i=t.dbWrapper.createTransaction(t.dbWrapper.optionsGenerator(n.readonly,e,a,o)).objectStore(e).count(r)).onerror=function(e){return a(e)},i.onsuccess=function(e){return o(e.target.result)}})},e.prototype.update=function(e,r,t){var o=this;return new Promise(function(a,i){o.dbWrapper.validateBeforeTransaction(e,i),o.dbWrapper.createTransaction(o.dbWrapper.optionsGenerator(n.readwrite,e,i,a)).objectStore(e).put(r,t)})},e.prototype.delete=function(e,r){var t=this;return new Promise(function(o,a){t.dbWrapper.validateBeforeTransaction(e,a),t.dbWrapper.createTransaction(t.dbWrapper.optionsGenerator(n.readwrite,e,a,o)).objectStore(e).delete(r)})},e.prototype.deleteDatabase=function(){var e=this;return new Promise(function(r,t){e.dbWrapper.db.close();var o=e.utils.indexedDB.deleteDatabase(e.dbWrapper.dbName);o.onsuccess=r,o.onerror=t,o.onblocked=function(){throw new Error("Unable to delete database because it's blocked")}})},e.prototype.openCursor=function(e,r,t){var o=this;return new Promise(function(a,i){o.dbWrapper.validateBeforeTransaction(e,i),o.dbWrapper.createTransaction(o.dbWrapper.optionsGenerator(n.readonly,e,i,a)).objectStore(e).openCursor(t).onsuccess=function(e){r(e),a()}})},e.prototype.clear=function(e){var r=this;return new Promise(function(t,o){r.dbWrapper.validateBeforeTransaction(e,o),r.dbWrapper.createTransaction(r.dbWrapper.optionsGenerator(n.readwrite,e,o,t)).objectStore(e).clear(),t()})},e.prototype.getByIndex=function(e,r,t){var o=this;return new Promise(function(a,i){o.dbWrapper.validateBeforeTransaction(e,i),o.dbWrapper.createTransaction(o.dbWrapper.optionsGenerator(n.readonly,e,i,a)).objectStore(e).index(r).get(t).onsuccess=function(e){a(e.target.result)}})},e}();var t=function(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB};var o=function(){function e(e,r){this.dbName=e,this.dbVersion=r||1}return e.prototype.validateStoreName=function(e){return this.db.objectStoreNames.contains(e)},e.prototype.validateBeforeTransaction=function(e,r){this.db||r("You need to use the openDatabase function to create a database before you query it!"),this.validateStoreName(e)||r("objectStore does not exists: "+e)},e.prototype.createTransaction=function(e){var r=this.db.transaction(e.storeName,e.dbMode);return r.onerror=e.error,r.oncomplete=e.complete,r.onabort=e.abort,r},e.prototype.optionsGenerator=function(e,r,t,o){return{storeName:r,dbMode:e,error:function(e){t(e)},complete:function(e){o()},abort:function(e){t(e)}}},e}();var n={readonly:"readonly",readwrite:"readwrite"};e.NgxIndexedDB=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-indexed-db.umd.min.js.map