/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { ToastrService } from 'ngx-toastr';
import { NgbModal } from '@ng-bootstrap/ng-bootstrap';
var UcgridviewComponent = /** @class */ (function () {
    function UcgridviewComponent(http, toastr, modalService) {
        this.http = http;
        this.toastr = toastr;
        this.modalService = modalService;
        this.output = new EventEmitter();
        this.select = new EventEmitter();
        this.isSeq = false;
        this.pageNow = 1;
        this.pageSize = 10;
        this.orderByKey = null;
        this.orderByValue = true;
    }
    /**
     * @return {?}
     */
    UcgridviewComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.initiateForm();
    };
    /**
     * @return {?}
     */
    UcgridviewComponent.prototype.initiateForm = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.getJSON(this.gridInput.pagingJson).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            console.log(data);
            _this.isSeq = data.isSeq;
            _this.headerList = data.headerList;
            _this.bodyList = data.bodyList;
        }));
    };
    /**
     * @param {?} url
     * @return {?}
     */
    UcgridviewComponent.prototype.getJSON = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        return this.http.get(url);
    };
    /**
     * @param {?} item
     * @param {?} param
     * @return {?}
     */
    UcgridviewComponent.prototype.genAction = /**
     * @param {?} item
     * @param {?} param
     * @return {?}
     */
    function (item, param) {
        /** @type {?} */
        var arrList = {};
        for (var i = 0; i < param.length; i++) {
            if (item[param[i].type] != undefined || item[param[i].param] != undefined) {
                arrList[param[i].type] = item[param[i].property];
            }
            else {
                arrList[param[i].type] = param[i].property;
            }
        }
        return arrList;
    };
    /**
     * @param {?} item
     * @param {?} condList
     * @return {?}
     */
    UcgridviewComponent.prototype.switchCase = /**
     * @param {?} item
     * @param {?} condList
     * @return {?}
     */
    function (item, condList) {
        /** @type {?} */
        var condition = false;
        for (var i = 0; i < condList.conditions.length; i++) {
            if (item[condList.conditions[i].property] == condList.conditions[i].value) {
                condition = true;
            }
            else {
                condition = false;
                break;
            }
        }
        return condition;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UcgridviewComponent.prototype.searchSort = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.orderByKey == event.target.attributes.name.nodeValue) {
            this.orderByValue = !this.orderByValue;
        }
        else {
            this.orderByValue = true;
        }
        this.orderByKey = event.target.attributes.name.nodeValue;
        /** @type {?} */
        var gridOutput = {
            orderByKey: this.orderByKey,
            orderByValue: this.orderByValue
        };
        this.output.emit(gridOutput);
        /** @type {?} */
        var order = {
            key: this.orderByKey,
            value: this.orderByValue
        };
        this.gridInput.searchComp.search(this.gridInput.apiUrl, this.gridInput.pageNow, this.gridInput.pageSize, order);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UcgridviewComponent.prototype.searchPagination = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.pageNow = event;
        /** @type {?} */
        var order = null;
        if (this.orderByKey != null) {
            order = {
                key: this.orderByKey,
                value: this.orderByValue
            };
        }
        this.gridInput.searchComp.search(this.gridInput.apiUrl, this.pageNow, this.pageSize, order);
    };
    /**
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    UcgridviewComponent.prototype.delete = /**
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    function (key, value) {
        var _this = this;
        if (confirm("Are you sure to delete this record?")) {
            /** @type {?} */
            var delId = {};
            delId[key] = value;
            this.http.post(this.gridInput.deleteUrl, delId).subscribe((/**
             * @param {?} response
             * @return {?}
             */
            function (response) {
                _this.toastr.success(response['message'], 'Success!');
                _this.searchPagination(_this.pageNow);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                console.log(error);
            }));
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    UcgridviewComponent.prototype.choose = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        this.select.emit(item);
        this.modalService.dismissAll();
    };
    UcgridviewComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-ucgridview',
                    template: "<div [hidden]=\"gridInput?.resultData?.Data == null\">\r\n  <table class=\"table table-responsive-md text-center table-hover\">\r\n    <thead>\r\n      <tr class=\"table-header\">\r\n        <th *ngIf=\"isSeq == true\">No</th>\r\n        <th *ngFor=\"let head of headerList\"\r\n          [ngClass]=\"[head.position == 'left' ? 'text-left' : '', head.position == 'right' ? 'text-right' : '' , head.width == undefined || head.width == '' ? '' : head.width]\">\r\n          <span *ngIf=\"head.type == 'sort'\" translate class=\"thead-header\" (click)=\"searchSort($event)\"\r\n            attr.name=\"{{head.name}}\">{{head.label}}</span>\r\n          <span *ngIf=\"head.type == 'label'\">{{head.label}}</span>\r\n        </th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor=\"let item of gridInput?.resultData?.Data; let i = index\">\r\n        <td *ngIf=\"isSeq == true\">{{ i+1 }}</td>\r\n        <td *ngFor=\"let body of bodyList\" [ngClass]=\"{ 'text-left': body.position == 'left',\r\n                     'text-right': body.position == 'right' }\">\r\n          <span *ngIf=\"body.type == 'text'\">{{ item[body.property] }}</span>\r\n          <span *ngIf=\"body.type == 'decimal'\">{{ item[body.property] | number }}</span>\r\n          <span *ngIf=\"body.type == 'date'\">{{ item[body.property] | date: 'dd-MMM-yyyy' }}</span>\r\n          <span *ngIf=\"body.type == 'link'\">\r\n            <a [target]=\"body.target\" [routerLink]=\"[body.path]\"\r\n              [queryParams]=\"genAction(item,body.param)\">{{ item[body.property] }}</a>\r\n          </span>\r\n          <span *ngIf=\"body.type == 'boolean'\">\r\n            <span *ngIf=\"item[body.property] == '1'\">Yes</span>\r\n            <span *ngIf=\"item[body.property] == '0'\">No</span>\r\n            <span *ngIf=\"item[body.property] == '' || item[body.property] == null\">-</span>\r\n          </span>\r\n          <span *ngIf=\"body.type == 'action'\">\r\n            <span *ngFor=\"let act of body?.action\">\r\n              <span *ngIf=\"act.type == 'edit'\">\r\n                <a class=\"success p-0\" [routerLink]=\"[act.path]\" [queryParams]=\"genAction(item,act.param)\">\r\n                  <i class=\"font-medium-3 mr-2\"\r\n                    [ngClass]=\" act.icon == undefined || act.icon == '' ? 'ft-edit-2' : act.icon \"></i>\r\n                </a>\r\n              </span>\r\n              <span *ngIf=\"act.type == 'delete'\">\r\n                <a class=\"danger p-0\" (click)=\"delete(act.property,item[act.property])\">\r\n                  <i class=\"font-medium-3 mr-2\"\r\n                    [ngClass]=\" act.icon == undefined || act.icon == '' ? 'ft-trash-2 ' : act.icon \"></i>\r\n                </a>\r\n              </span>\r\n              <span *ngIf=\"act.type == 'select'\">\r\n                <a class=\"primary p-0 bold\" (click)=\"choose(item)\">\r\n                  select\r\n                </a>\r\n              </span>\r\n              <span *ngIf=\"act.type == 'switch'\">\r\n                <span *ngFor=\"let cs of act?.case\">\r\n                  <span *ngIf=\"switchCase(item,cs) && cs.isHide != true\">\r\n                    <a class=\"success p-0\" [routerLink]=\"[cs.result.path]\"\r\n                      [queryParams]=\"genAction(item,cs.result.param)\">\r\n                      <i class=\"font-medium-3 mr-2\"\r\n                        [ngClass]=\" cs.icon == undefined || cs.icon == '' ? 'ft-edit-2' : cs.icon \"></i>\r\n                    </a>\r\n                  </span>\r\n                </span>\r\n              </span>\r\n            </span>\r\n          </span>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    UcgridviewComponent.ctorParameters = function () { return [
        { type: HttpClient },
        { type: ToastrService },
        { type: NgbModal }
    ]; };
    UcgridviewComponent.propDecorators = {
        gridInput: [{ type: Input }],
        output: [{ type: Output }],
        select: [{ type: Output }]
    };
    return UcgridviewComponent;
}());
export { UcgridviewComponent };
if (false) {
    /** @type {?} */
    UcgridviewComponent.prototype.gridInput;
    /** @type {?} */
    UcgridviewComponent.prototype.output;
    /** @type {?} */
    UcgridviewComponent.prototype.select;
    /** @type {?} */
    UcgridviewComponent.prototype.pagingJson;
    /** @type {?} */
    UcgridviewComponent.prototype.headerList;
    /** @type {?} */
    UcgridviewComponent.prototype.bodyList;
    /** @type {?} */
    UcgridviewComponent.prototype.isSeq;
    /** @type {?} */
    UcgridviewComponent.prototype.pageNow;
    /** @type {?} */
    UcgridviewComponent.prototype.pageSize;
    /** @type {?} */
    UcgridviewComponent.prototype.orderByKey;
    /** @type {?} */
    UcgridviewComponent.prototype.orderByValue;
    /**
     * @type {?}
     * @private
     */
    UcgridviewComponent.prototype.http;
    /** @type {?} */
    UcgridviewComponent.prototype.toastr;
    /**
     * @type {?}
     * @private
     */
    UcgridviewComponent.prototype.modalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWNncmlkdmlldy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly91Y2dyaWR2aWV3LyIsInNvdXJjZXMiOlsibGliL3VjZ3JpZHZpZXcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQy9FLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUVsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUV0RDtJQXFCRSw2QkFBb0IsSUFBZ0IsRUFBUyxNQUFxQixFQUFVLFlBQXNCO1FBQTlFLFNBQUksR0FBSixJQUFJLENBQVk7UUFBUyxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQVUsaUJBQVksR0FBWixZQUFZLENBQVU7UUFieEYsV0FBTSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBQy9DLFdBQU0sR0FBc0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUt6RCxVQUFLLEdBQVEsS0FBSyxDQUFDO1FBRW5CLFlBQU8sR0FBUSxDQUFDLENBQUM7UUFDakIsYUFBUSxHQUFRLEVBQUUsQ0FBQztRQUNuQixlQUFVLEdBQVEsSUFBSSxDQUFDO1FBQ3ZCLGlCQUFZLEdBQVksSUFBSSxDQUFDO0lBRXlFLENBQUM7Ozs7SUFFdkcsc0NBQVE7OztJQUFSO1FBQ0UsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3RCLENBQUM7Ozs7SUFFRCwwQ0FBWTs7O0lBQVo7UUFBQSxpQkFRQztRQVBDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxJQUFJO1lBQ3BELE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENB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Q3JCLENBQUMsRUFBQyxDQUFDO1NBQ047SUFDSCxDQUFDOzs7OztJQUVELG9DQUFNOzs7O0lBQU4sVUFBTyxJQUFJO1FBQ1QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkIsSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUNqQyxDQUFDOztnQkFySEYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxnQkFBZ0I7b0JBQzFCLDZuSEFBMEM7aUJBRTNDOzs7O2dCQVRRLFVBQVU7Z0JBRVYsYUFBYTtnQkFDYixRQUFROzs7NEJBU2QsS0FBSzt5QkFDTCxNQUFNO3lCQUNOLE1BQU07O0lBNkdULDBCQUFDO0NBQUEsQUF0SEQsSUFzSEM7U0FqSFksbUJBQW1COzs7SUFFOUIsd0NBQXdCOztJQUN4QixxQ0FBeUQ7O0lBQ3pELHFDQUF5RDs7SUFFekQseUNBQWdCOztJQUNoQix5Q0FBZ0I7O0lBQ2hCLHVDQUFjOztJQUNkLG9DQUFtQjs7SUFFbkIsc0NBQWlCOztJQUNqQix1Q0FBbUI7O0lBQ25CLHlDQUF1Qjs7SUFDdkIsMkNBQTZCOzs7OztJQUVqQixtQ0FBd0I7O0lBQUUscUNBQTRCOzs7OztJQUFFLDJDQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBUb2FzdHJTZXJ2aWNlIH0gZnJvbSAnbmd4LXRvYXN0cic7XHJcbmltcG9ydCB7IE5nYk1vZGFsIH0gZnJvbSAnQG5nLWJvb3RzdHJhcC9uZy1ib290c3RyYXAnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdsaWItdWNncmlkdmlldycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3VjZ3JpZHZpZXcuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlczogW11cclxufSlcclxuZXhwb3J0IGNsYXNzIFVjZ3JpZHZpZXdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICBASW5wdXQoKSBncmlkSW5wdXQ6IGFueTtcclxuICBAT3V0cHV0KCkgb3V0cHV0OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgc2VsZWN0OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBcclxuICBwYWdpbmdKc29uOiBhbnk7XHJcbiAgaGVhZGVyTGlzdDogYW55O1xyXG4gIGJvZHlMaXN0OiBhbnk7XHJcbiAgaXNTZXE6IGFueSA9IGZhbHNlO1xyXG5cclxuICBwYWdlTm93OiBhbnkgPSAxO1xyXG4gIHBhZ2VTaXplOiBhbnkgPSAxMDtcclxuICBvcmRlckJ5S2V5OiBhbnkgPSBudWxsO1xyXG4gIG9yZGVyQnlWYWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCwgcHVibGljIHRvYXN0cjogVG9hc3RyU2VydmljZSwgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IE5nYk1vZGFsKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmluaXRpYXRlRm9ybSgpO1xyXG4gIH1cclxuXHJcbiAgaW5pdGlhdGVGb3JtKCkge1xyXG4gICAgdGhpcy5nZXRKU09OKHRoaXMuZ3JpZElucHV0LnBhZ2luZ0pzb24pLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIHRoaXMuaXNTZXEgPSBkYXRhLmlzU2VxO1xyXG4gICAgICB0aGlzLmhlYWRlckxpc3QgPSBkYXRhLmhlYWRlckxpc3Q7XHJcbiAgICAgIHRoaXMuYm9keUxpc3QgPSBkYXRhLmJvZHlMaXN0O1xyXG5cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0SlNPTih1cmw6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpO1xyXG4gIH1cclxuXHJcbiAgZ2VuQWN0aW9uKGl0ZW0sIHBhcmFtKSB7XHJcbiAgICB2YXIgYXJyTGlzdCA9IHt9O1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGl0ZW1bcGFyYW1baV0udHlwZV0gIT0gdW5kZWZpbmVkIHx8IGl0ZW1bcGFyYW1baV0ucGFyYW1dICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGFyckxpc3RbcGFyYW1baV0udHlwZV0gPSBpdGVtW3BhcmFtW2ldLnByb3BlcnR5XTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcnJMaXN0W3BhcmFtW2ldLnR5cGVdID0gcGFyYW1baV0ucHJvcGVydHk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcnJMaXN0O1xyXG4gIH1cclxuICBcclxuICBzd2l0Y2hDYXNlKGl0ZW0sIGNvbmRMaXN0KSB7XHJcbiAgICB2YXIgY29uZGl0aW9uID0gZmFsc2U7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25kTGlzdC5jb25kaXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChpdGVtW2NvbmRMaXN0LmNvbmRpdGlvbnNbaV0ucHJvcGVydHldID09IGNvbmRMaXN0LmNvbmRpdGlvbnNbaV0udmFsdWUpIHtcclxuICAgICAgICBjb25kaXRpb24gPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbmRpdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29uZGl0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2VhcmNoU29ydChldmVudDogYW55KSB7XHJcbiAgICBpZiAodGhpcy5vcmRlckJ5S2V5ID09IGV2ZW50LnRhcmdldC5hdHRyaWJ1dGVzLm5hbWUubm9kZVZhbHVlKSB7XHJcbiAgICAgIHRoaXMub3JkZXJCeVZhbHVlID0gIXRoaXMub3JkZXJCeVZhbHVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5vcmRlckJ5VmFsdWUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5vcmRlckJ5S2V5ID0gZXZlbnQudGFyZ2V0LmF0dHJpYnV0ZXMubmFtZS5ub2RlVmFsdWU7XHJcbiAgICB2YXIgZ3JpZE91dHB1dCA9IHtcclxuICAgICAgb3JkZXJCeUtleTogdGhpcy5vcmRlckJ5S2V5LFxyXG4gICAgICBvcmRlckJ5VmFsdWU6IHRoaXMub3JkZXJCeVZhbHVlXHJcbiAgICB9XHJcbiAgICB0aGlzLm91dHB1dC5lbWl0KGdyaWRPdXRwdXQpO1xyXG4gICAgdmFyIG9yZGVyID0ge1xyXG4gICAgICBrZXk6IHRoaXMub3JkZXJCeUtleSxcclxuICAgICAgdmFsdWU6IHRoaXMub3JkZXJCeVZhbHVlXHJcbiAgICB9XHJcbiAgICB0aGlzLmdyaWRJbnB1dC5zZWFyY2hDb21wLnNlYXJjaCh0aGlzLmdyaWRJbnB1dC5hcGlVcmwsIHRoaXMuZ3JpZElucHV0LnBhZ2VOb3csIHRoaXMuZ3JpZElucHV0LnBhZ2VTaXplLCBvcmRlcik7XHJcbiAgfVxyXG5cclxuICBzZWFyY2hQYWdpbmF0aW9uKGV2ZW50OiBudW1iZXIpIHtcclxuICAgIHRoaXMucGFnZU5vdyA9IGV2ZW50O1xyXG4gICAgdmFyIG9yZGVyID0gbnVsbDtcclxuICAgIGlmICh0aGlzLm9yZGVyQnlLZXkgIT0gbnVsbCkge1xyXG4gICAgICBvcmRlciA9IHtcclxuICAgICAgICBrZXk6IHRoaXMub3JkZXJCeUtleSxcclxuICAgICAgICB2YWx1ZTogdGhpcy5vcmRlckJ5VmFsdWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5ncmlkSW5wdXQuc2VhcmNoQ29tcC5zZWFyY2godGhpcy5ncmlkSW5wdXQuYXBpVXJsLCB0aGlzLnBhZ2VOb3csIHRoaXMucGFnZVNpemUsIG9yZGVyKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZShrZXk6IGFueSwgdmFsdWU6IGFueSkge1xyXG4gICAgaWYgKGNvbmZpcm0oXCJBcmUgeW91IHN1cmUgdG8gZGVsZXRlIHRoaXMgcmVjb3JkP1wiKSkge1xyXG4gICAgICB2YXIgZGVsSWQgPSB7fTtcclxuICAgICAgZGVsSWRba2V5XSA9IHZhbHVlO1xyXG4gICAgICB0aGlzLmh0dHAucG9zdCh0aGlzLmdyaWRJbnB1dC5kZWxldGVVcmwsIGRlbElkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnRvYXN0ci5zdWNjZXNzKHJlc3BvbnNlWydtZXNzYWdlJ10sICdTdWNjZXNzIScpO1xyXG4gICAgICAgICAgdGhpcy5zZWFyY2hQYWdpbmF0aW9uKHRoaXMucGFnZU5vdyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAoZXJyb3IpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNob29zZShpdGVtKSB7XHJcbiAgICB0aGlzLnNlbGVjdC5lbWl0KGl0ZW0pO1xyXG4gICAgdGhpcy5tb2RhbFNlcnZpY2UuZGlzbWlzc0FsbCgpO1xyXG4gIH1cclxufVxyXG4iXX0=